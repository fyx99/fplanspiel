<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Spiel starten</title>
       <!--  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>--> 
   	<script src="jquery/jquery-1.11.0.min.js"></script>
    <script src="js/bootstrap.min.js"></script>
    
    <link href="css/bootstrap.min.css" rel="stylesheet">
    <link href="css/custom.css" rel="stylesheet">
    <link href="http://netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css" rel="stylesheet">
    <link href='http://fonts.googleapis.com/css?family=Open+Sans' rel='stylesheet' type='text/css'>
    <link href='http://fonts.googleapis.com/css?family=Oswald' rel='stylesheet' type='text/css'>
  </head>
  <body>
    <!-- Fixed navbar -->
    <div class="navbar navbar-default navbar-fixed-top" role="navigation">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="start.html">Unternehmensplanspiel</a>		<!--zeigt auf start-->
        </div>
        <div class="navbar-collapse collapse">
          <ul class="nav navbar-nav navbar-default"></ul>
        </div><!--/.nav-collapse -->
      </div>
    </div>
    
	<div class="container pt-5">

        <div class="page-header">
            <h1>Neues Spiel</h1>
        </div>	
            	<h3>Bitte wählen Sie die Länge des Spiels und die Anzahl der Spieler aus!</h3>

                <style> 
                table {
                    font-family: arial, sans-serif;
                    border-collapse: collapse;
                    width: 100%;
                    }

                td, th {
                    border: 1px solid #dddddd;
                    text-align: left;
                    border-collapse: separate;
                    padding: 8px;
                    }

                    .panelTop{
      				margin-top: 2px;
    				margin-bottom: 2px;
    				}

    				.form-check-input {
    				width: 15px;
    				height: 15px;
    				}

        			.blockButton{
        			width: 60px;
        			height: 60px;
        			}

        			.borderless td, .borderless th {
            		border: none;
        			}
                </style>
                
                <div class="panel panel-default">
      				<div class="panel-heading">
        				<h4 class="panelTop">Länge des Spiels</h4>
      				</div>
      				<div class="panel-body">
                    		<div class="btn-group" role="group" aria-label="rundenzahl">
                    		<button type="button" onclick="changeRoundCount('2')" class="btn btn-primary">Demo (2 Runden)</button>
                            	<button type="button" onclick="changeRoundCount('6')" class="btn btn-primary">Kurz (6 Runden)</button>
                            	<button type="button" onclick="changeRoundCount('12')" class="btn btn-primary">Mittel (12 Runden)</button>
                            	<button type="button" onclick="changeRoundCount('20')" class="btn btn-primary">Lang (20 Runden)</button>
                    	</div>
                    </div>
                </div>

    <!--Spielerauswahl--> 
	<div class="panel-group" id="accordion">
		<div class="panel panel-default" id="contentStartseite">
		
  		</div>
  		
	</div>
	
	<script>
	
	function printMitarbeiter(){
			var cont  = document.getElementById('contentStartseite');
			var s ="";
			
		for(var i =1; i <= 8; i++){
				
				s += 		'<!--Panel Spieler' + i + '-->' +
		  		'<div class="panel panel-default">' +
	    		'<div class="panel-heading">' +
	      			'<h4 class="panel-title">' +
	        			'<a data-toggle="collapse" data-parent="#accordion" href="#collapse' + i +'">' +
	        			'Spieler ' + i + 
	        			'</a>' +
	      			'</h4>' +
	    		'</div>' +
	    		'<div id="collapse'+i +'" class="panel-collapse collapse">'+
	    		'<div class="panel-body">' +
	  					
	    		'<table style="row">' +
	    		' <tr>' +
	    		' <td style="text-align: center; width: 5%">' +
	    		' <div class="form-check">' +
	    		'<input class="form-check-input" type="checkbox" value="" id="defaultCheck' + i + '" onclick="changePlayerCount(\x27defaultCheck'+i+'\x27)" >'+
	            '                    </div>' +
	              '              </td>' +
	              '<td>' +
	              '<input id="firma' + i + '" name="firmaSpieler' + i + '" placeholder="Firma" style="width: 200px">' +
	              '<p></p>' +
	              
	              
	     /*          '<div class="dropdown" padding="20px" style="width: 200px">' +
	              '<button class="btn btn-primary btn-sm dropdown-toggle" style="width: 200px" type="button" id="dropdownMenuSpieler' + i +'"" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">' + 
	              'Unternehmensform' +
	              '<span class="caret"></span>' +
	              '</button>' +
	              '<ul class="dropdown-menu" aria-labelledby="dropdownMenuSpieler' + i+ '">' +
	              '<li><a onclick="changePlayerFirma(\x27dropdownMenuSpieler' +  i + '\x27, \x27AG\x27)">AG</a></li>'+
	              '<li><a onclick="changePlayerFirma(\x27dropdownMenuSpieler' + i + '\x27, \x27GmbH\x27)">GmbH</a></li>'+
	              '<li><a onclick="changePlayerFirma(\x27dropdownMenuSpieler' + i + '\x27, \x27OHG\x27)">OHG</a></li>'+
	              '<li><a onclick="changePlayerFirma(\x27dropdownMenuSpieler' + i + '\x27, \x27KG\x27)">KG</a></li>'+
	              '<li><a onclick="changePlayerFirma(\x27dropdownMenuSpieler' + i + '\x27, \x27eK\x27)">eK</a></li>'+
	              '<li><a onclick="changePlayerFirma(\x27dropdownMenuSpieler' + i + '\x27, \x27GmbH & Co.KG\x27)">GmbH & Co.KG</a></li>'+
	              '<li><a onclick="changePlayerFirma(\x27dropdownMenuSpieler' + i + '\x27, \x27UG\x27)">UG</a></li>'+
	              '</ul>' +
	              '</div>' + */
	              '</td>' +

	              '<td>' +
	              '<p>Bitte wählen Sie eine Region aus! Jede Region hat seine Vor- und Nachteile!' +
	              '<table class="borderless" style="width: 75%">' +
	              '<tr>' +
	              '<td style="text-align: right;">' +
	              '<button onclick="changeRegion(\x27regionSpieler' + i+ '\x27, \x27A\x27)" class="btn btn-primary blockButton" data-tooltip-id="tooltip1" data-toggle="tooltip" data-placement ="left" title="- Niedrige Mitarbeiterkosten<br/>- Höhere Angebotsattraktivität<br/> - Aber: Ineffiziente Marketingmaßnahmen " >A</button>' +
	              
	              
	              
	              '</td>' +
	              ' <td style="text-align: left;">' +
	            
	              '<button onclick="changeRegion(\x27regionSpieler'+i +'\x27, \x27B\x27)" class="btn btn-primary blockButton" data-tooltip-id="tooltip2" data-toggle="tooltip" data-placement="right" title="- Niedrige Materialkosten <br/>- Effiziente Marketingmaßnahmen<br/> - Aber: Höhere Fertigungskosten " >B</button>'+
	              '</td>' +
	              '</tr>' +
	              '<tr>' +
	              '<td style="text-align: right;"> ' +
	              '<button onclick="changeRegion(\x27regionSpieler' + i+ '\x27, \x27C\x27)" class="btn btn-primary blockButton" data-tooltip-id="tooltip3" data-toggle="tooltip" data-placement="left" title="- Erfolgreichere Marketingmaßnahmen <br/>- Höhere Angebotsattraktivität <br/>- Aber: Höhere Fertigungs- und Mitarbeiterkosten<br/> " >C</button>' + 
	              '</td>' +
	              '<td style="text-align: left;">' +
	              '<button onclick="changeRegion(\x27regionSpieler' + i+ '\x27, \x27D\x27)" class="btn btn-primary blockButton" data-tooltip-id="tooltip4" data-toggle="tooltip" data-placement="right" title="- Niedrige Mitarbeiterkosten <br/>- Niedrige Fertigungskosten <br/> - Aber: Höhere Materialkosten" >D</button>' +
	              '</td>' +
	              '</tr>' +
	              '</table>' +
	              '<p id="regionSpieler' + i +'">Gewählte Region:</p>' +
	              '</td>' +
	              '<td>' +
	              '<button type="button" id="unternehmen' + i + '" onclick="unternehmenHinzufuegen(this)" class="btn btn-primary">Unternehmen hinzufügen</button>' +
	              '<p></p>'+
	              '<p id="fehlermeldung' + i +'"></p>' +
	              '</td>' +
	              '</tr>' +
	              '</table>' +
	              '</div>' +
	              '</div>' +
	              '</div>' 
		}
		cont.innerHTML = s;
		
		}
	</script>

				<hr>
                <h3>Übersicht</h3>

				<style>
					.gameSummary {
						color: green;
						font-size: 15px;
					}
				</style>
				
<!-- 				<div class="container">
				<img src="img/deutschland.jpg" width="145" height="126" alt="deutschland" usemap="#deutschlandmap">

<map name="deutschlandmap">
  <area shape="circle" coords="20,20,20" data-toggle="tooltip" data-placement="left" >
  <area shape="circle" coords="20,40,20" data-toggle="tooltip" data-placement="right">
  <area shape="circle" coords="40,20,20" data-toggle="tooltip" data-placement="left">
  <area shape="circle" coords="40,40,20" data-toggle="tooltip" data-placement="right">
</map>
</div> -->

				<div class="well well-sm">
					<p class="gameSummary">Anzahl der Spieler: 				
						<p style="font-weight: bold" id="anzahlSpielerText">2 Spieler</p> <!--damit zwangsweise etwas ausgewählt ist-->
					</p>

					<p class="gameSummary">Anzahl der Runden:
						<p style="font-weight: bold" id="anzahlRundenText">6 Runden</p> <!--damit zwangsweise etwas ausgewählt ist-->
					</p>
				</div>

                <p></p>
                <hr>

               
				<p></p>
						
            	<button type="button" id="button" onclick="spielStarten()" class="btn btn-primary float-right" >Spiel starten</button>	<!--HIER NOCH DATEN ÜBERMITTELN-->
				<p></p>
				<!-- data-toggle="modal" data-target="#modalContent"  -->
                <p id="fehlermeldungSpielStarten"></p>
                            	
        <script type="text/javascript">


    </script>
        </div>	

    <!-- Modal -->
        <div class="modal fade" id="modalContent" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
          <div class="modal-dialog">
            <!-- Modal content-->
            <div class="modal-content">
              <div class="modal-header">
                <h4 class="modal-title">Hinweis</h4>
              </div>
              <div class="modal-body">
                <h2>Die Unternehmenssimulation startet in 30 Sekunden!</h2>
                    <br>
                    <p>Du kannst im Navigationsbereich die Elemente Beschaffung, Verarbeitung und Verkauf auswählen und entsprechend Produkte produzieren.</p>
                    <p>Nach jeder Runde erhälst du eine Übersicht und kannst deine Ergebnisse mit denen der anderen Spieler vergleichen.</p>
					<br>
                    <p>Viel Erfolg!</p>
              </div>
            </div>

          </div>
        </div>
	
		    
    <!-- Fixed footer -->
    <div class="navbar navbar-inverse navbar-fixed-bottom" role="navigation">
        <div class="container">
            <div class="navbar-text pull-left">
                <p>© 2018 </p>
            </div>
            <div class="navbar-text pull-right">
                <a href="#help">Hilfe</a>       
            </div>
        </div>
    </div>
    
    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script>
	    $(document).ready(function() {
	    	printMitarbeiter();
	    	
	    	
	    	// Noch als Backup
	    	
	    	
	    	// $('[data-toggle="tooltip"]').tooltip();
	    	
	  /*   	$('[data-toggle="tooltip"]').each(function () {
			    // now have instance access to "this"
			    var $this = $(this),
			        tipId = $this.data('tooltip-id');
			    
			    console.log("tipId" + tipId);
			    var tips = tipId;
			    console.log("tips" + tips);
			    // initialize instance of plugin
			    
			    if (tips == "tooltip1"){
			    	console.log("hihi");
			    	title: "hi";
			    }
			    
			    $this.tooltip({
			    	console.log("hi");
			    	
			    	
			        
			    });
			}); */
	    	

	     	$('[data-toggle="tooltip"]').tooltip({
	    		track: true,
	    	    //title: hoverGetData(),
	    	   // html: true,
	    	    container: 'body',
	    	    html: true,

	    		 }); 

	    	
	    	jQuery.ajax({
        		
		 		url: "../api/spiel/neuesspiel",
		 		type: "GET",
		 		sucess: function() {
		 			confirm("Neues Spiel eröffnet");
		 			location.reload(true);
		 		},
			    error: function() {
			        console.log("Fehler");
			    }
	 		});
	        });
	    
	    // Noch als Backup
	    function hoverGetData(){
   		 console.log("test");
   		/*  $.ajax({
 		    url:"../api/spiel/neuesspiel",
 		    type: "GET"
 			sucess: function() {
		 			confirm("Unternehmen hinzugefuegt");
		 			location.reload(true);
		 			 console.log("Erfolg");
		 		},
			    error: function() {
			        console.log("Fehler");
			    } 
	 		});*/
 		   
	 		
 		   return "Dieser Standort bietet folgende Vorteile:";
	    }
    
    	var standort = "";
        var anzahlSpieler = 0;
        var rundenAnzahl = 6;
        
        var erstesUnternehmenHinzugefuegt = false;
        var zweitesUnternehmenHinzugefuegt = false;
        
        function spielStarten() {
        	
        	if (erstesUnternehmenHinzugefuegt == true && zweitesUnternehmenHinzugefuegt == true) {
        		
            	//http://localhost:8080/pplanspiel/api/spiel/starten?rundenZahl=20%20Runden
            	console.log("rundenanzahl"+rundenAnzahl);
            	jQuery.ajax({
            		
    		 		url: "../api/spiel/starten?rundenZahl=" + rundenAnzahl,
    		 		type: "GET",
    		 		sucess: function() {
    		 			confirm("Unternehmen hinzugefuegt");
    		 			location.reload(true);
    		 			 console.log("Erfolg");
    		 		},
    			    error: function() {
    			        console.log("Fehler");
    			    }
    	 		});
            	
            	$('#modalContent').modal({
            		  keyboard: true, //ESC-Taste schließt Modal
            		  backdrop: true, //beim Klick außerhalb des Modals, wird dieses geschlossen (sonst "static")
            		  show: true, //Modal wird nach dem Initialisieren angezeigt
            		});
            	
            	loadNextPage();
            	
        	} else {
        		document.getElementById('fehlermeldungSpielStarten').innerHTML = "Es müssen mindestens zwei Unternehmen hinzugefügt werden, um das Spiel zu starten.";
        		setColourRed(document.getElementById('fehlermeldungSpielStarten'));
        		
        		console.log(erstesUnternehmenHinzugefuegt+"test1");
     			

        	}

        }
        		
        function loadNextPage(){
             window.setTimeout(function(){
            window.location.href = "einkauf.html";
            }, 1000); //Test: 1sec 
        }
        

        document.getElementById('anzahlSpielerText').innerHTML = anzahlSpieler + " Spieler";

        function changePlayerCount(checkBoxID) {
            var checkBoxObject = document.getElementById(checkBoxID);
            if (checkBoxObject.checked == true) {
                anzahlSpieler = anzahlSpieler + 1;
            } else {
                anzahlSpieler = anzahlSpieler - 1;
            }
            document.getElementById('anzahlSpielerText').innerHTML = anzahlSpieler + " Spieler";
        }

        function changeRoundCount(count){
        	document.getElementById('anzahlRundenText').innerHTML= count + " Runden";
        	rundenAnzahl=count;
        }

        function changePlayerFirma(player, firma){
        	document.getElementById(player).innerHTML = firma;
        }

        function changeRegion(player, region){
        	document.getElementById(player).innerHTML = "Gewählte Region: <b>" + region + "</b>";
        	standort = region;
        	console.log(standort+"test");
        }
        
        // Beim Klick auf Unternehmen hinzufuegen
        function unternehmenHinzufuegen(ele){
        	var firma;
        	//var standort;
    		//console.log(ele.id);
    		
    		for (var i=1;i<=8; i++){
    			if (ele.id == "unternehmen"+i){ 
         			firma = document.getElementById("firma"+i).value;
         			if (firma == "" && standort ==""){
         				document.getElementById("fehlermeldung"+i).innerHTML = "Bitte Firma und Region auswählen!";
         				setColourRed(document.getElementById("fehlermeldung" +i));
         			} else if (standort ==""){
         				document.getElementById("fehlermeldung" +i).innerHTML = "Bitte Region auswählen!";
         				setColourRed(document.getElementById("fehlermeldung" +i));
         			}else if (firma == "") {
         				document.getElementById("fehlermeldung" +i).innerHTML = "Bitte Firma auswählen!";
         				setColourRed(document.getElementById("fehlermeldung" +i));
         			} else {
         				callAjax(firma,standort);
         				document.getElementById("fehlermeldung"+i).innerHTML = "Unternehmen wurde hinzugefügt!";
         				setColourBlack(document.getElementById("fehlermeldung" +i));
         				
         				if (erstesUnternehmenHinzugefuegt == true) {
         					zweitesUnternehmenHinzugefuegt = true;
         				}
         				erstesUnternehmenHinzugefuegt = true;
         				
         				standort = "";
         			}
    			}
 			
    		}
        }
    		
    
        function setColourRed(element){
        	element.style.color = "#FF0000";
        }
        function setColourBlack(element){
        	element.style.color = "#000000";
        }
        
        function callAjax(firma, standort) {
        	jQuery.ajax({
		 		url: "../api/spiel/neuesunternehmen?name=" + firma + "&standort=" + standort,
		 		type: "GET",
		 		sucess: function() {
		 			confirm("Unternehmen hinzugefuegt");
		 			location.reload(true);
		 		},
			    error: function() {
			        console.log("Fehler");
			    }
	 		});   	
        }
    </script>


  </body>
</html>