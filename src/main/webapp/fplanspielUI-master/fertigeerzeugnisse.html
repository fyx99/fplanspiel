<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Fertige Erzeugnisse</title>
    <script src="jquery/jquery-1.11.0.min.js"></script>
    <script src="js/bootstrap.min.js"></script>
    <link href="css/bootstrap.min.css" rel="stylesheet">
    <link href="css/custom.css" rel="stylesheet">
    <link href="http://netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css" rel="stylesheet">
    <link href='http://fonts.googleapis.com/css?family=Open+Sans' rel='stylesheet' type='text/css'>
    <link href='http://fonts.googleapis.com/css?family=Oswald' rel='stylesheet' type='text/css'>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
 </head>
 
 <body onload="start()">
    <script>
      $(document).ready(function() {
          $('#navbar').load('navbar.html');
          getData();
          $('#footer').load('footer.html');
          //$('[data-toggle="tooltip"]').tooltip();
	  });
    </script>

	<script>
    var maxLagerKapazität = 1000;
	
    function getData(){
      jQuery.ajax({
        url: "../api/spiel/produkte",
        type: "GET",
        dataType: "json",
        success: function(data, data2){
          printData(data.produkte);
        }
      });
    }
    function printData(data){
      var cont  = document.getElementById('fertigeErzContent');
      var s ="";
      var index = 0;
      var bild = "";

      for(var produkt in data){
    	  if(data[produkt].p.name == "Holzstuhl"){
    		  bild = "img/holzstuhl2.jpg";
    	  } else if(data[produkt].p.name == "Stoffstuhl"){
    		  bild = "img/stoffstuhl.jpg";
    	  } else if(data[produkt].p.name == "Lederstuhl"){
    		  bild = "img/lederstuhl.jpg";
    	  } else if(data[produkt].p.name == "Holztisch"){
    		  bild = "img/holztisch.jpg";
    	  } else if(data[produkt].p.name == "Glastisch"){
    		  bild = "img/glastisch.jpg";
    	  } else if(data[produkt].p.name == "Kunststofftisch"){
    		  bild = "img/kunststofftisch.JPG";
    	  } else if(data[produkt].p.name == "Holzschrank"){
    		  bild = "img/holzschrank.jpg";
    	  } else if(data[produkt].p.name == "Edelstahlschrank"){
    		  bild = "img/edelstahlschrank.jpg";
    	  } else if(data[produkt].p.name == "Glasschrank"){
    		  bild = "img/glasschrank.jpg";
    	  }
    	  
        s += '<div class="col-sm-6 col-md-4">' + 
            '<div class="thumbnail">' + 
            '<img src="' + bild +'" alt="' + data[produkt].p.name + '">' + 
            '<div class="caption">' + 
            '<h3>' + data[produkt].p.name + '</h3>' + 
            '<p>Verfügbare Menge:</p>' + 
            '<div class="progress">' + 
            '<div class="progress-bar" role="progressbar" data-toggle="tooltip" title="' + data[produkt].menge + '/' + maxLagerKapazität + '" aria-valuenow="100" aria-valuemin="0" aria-valuemax="' + maxLagerKapazität + '" style="width:' + (data[produkt].menge * 100)/maxLagerKapazität + '%;">' + Math.round((data[produkt].menge * 100)/maxLagerKapazität) + '%</div>' + 
            '</div>' + 
            '<p><a href="verkauf.html" class="btn btn-danger" role="button">Verkaufen</a> <a onclick="loadData(' + index + ')" data-toggle="modal" data-target="#details" class="btn btn-primary" role="button">Details</a></p>' + 
            '</div></div></div>';

            index++;
      }
      if(index == 0){
    	  s = "<h4 style='padding-left: 18px'>Keine fertigen Erzeugnisse im Inventar vorhanden!</h4>";
      }
      cont.innerHTML = s;
    }
    </script>
    
    <!-- Fixed navbar -->
    <div id="navbar">
  </div>
    
	<!-- Page Header -->
	<div class="container">	
    	<div class="page-header">
      		<h1>Fertige Erzeugnisse</h1>
    	</div>
      <!--FERTIGE ERZEUGNISSE ÜBERSICHT-->
    	<div class="well">
        		<div class="row" id="fertigeErzContent">
        		

  				</div>
  		</div>
    </div>
	
   
    <!-- Fixed footer -->
    <div id="footer">
    </div>
    
    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->

<!--Modal-Details-->
  <div class="modal fade" id="details" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
     <div class="modal-dialog modal-dialog-centered" role="document">
       <div class="modal-content">
         <div class="modal-header">
           <button type="button" class="close" data-dismiss="modal" aria-label="Close">
             <span aria-hidden="true">&times;</span>
           </button>
           <h2 class="modal-title" id="DetailsDialogTitel">Details</h2>
         </div>
         <div class="modal-body" id="modalBodyID" style="font-size: 16px;">

			

         </div>
         <div class="modal-footer">
            <p>
              <button class="btn btn-primary" data-dismiss="modal" role="button">Schließen</button>
            </p>  
         </div>
       </div>
    </div>
  </div>
    
    <script>
    function loadData(index){
      jQuery.ajax({
        url: "../api/spiel/produkte",
        type: "GET",
        dataType: "json",
        success: function(data, data2){
          setValues(data.produkte, index);
        }
      });
    }
    
    function setValues(data, index){
    	document.getElementById('DetailsDialogTitel').innerHTML = "Details zu: " + data[index].p.name;
  
    	var inhalt = "";
	
    	inhalt += '<table class="table">' + 
		'<tr><td><b>Verfügbare Menge: </b></td><td>' + data[index].menge + ' ME</td</tr>' + 
		'<tr><td><b>Größe des Lagers</b></td><td>' + maxLagerKapazität + ' ME</td></tr>' + 
		'</table>' + 
		'<div class="progress">' + 
        '<div class="progress-bar progress-bar-success" role="progressbar" data-toggle="tooltip" title="' + data[index].menge + '/' + maxLagerKapazität + '" aria-valuenow="100" aria-valuemin="0" aria-valuemax="' + maxLagerKapazität + '" style="width:' + (data[index].menge * 100)/maxLagerKapazität + '%;">' + Math.round((data[index].menge * 100)/maxLagerKapazität) + '%</div>' + 
        '</div>';

    	document.getElementById('modalBodyID').innerHTML = inhalt;
    }
    </script>
  </body>
</html>