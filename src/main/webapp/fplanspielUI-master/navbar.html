<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="Bootstrap 3 Tutorial from BootstrapBay.com">
    <meta name="author" content="BootstrapBay.com">
    <title>BootstrapBay Tutorial</title>

 </head>

 <body onload="start()">

<script type="text/javascript">

	$(document).ready(function() {
 			getKapital();
 			getSpielername();
 			getRunde();
 		});
		function getKapital(){
			jQuery.ajax({
				url: "../api/spiel/unternehmen",
				type: "GET",
				dataType: "json",
				success: function(data, data2){
					var cont  = document.getElementById('exampleContent');
					var s =data.kapital;
					cont.innerHTML += s;
					console.log(data.kapital);
					//console.log(data.bmarkt.angebote);
					//console.log(data.mmarkt.angebote);

						/*for(var angebot in data){
				s += '<div class="col-sm-6 col-md-4"><div class="thumbnail"><img src="img/leder.jpg" alt="Leder"><div class="caption"><h3>' + data[angebot].markteinheit.name   +
						'</h3><p>Kommentar ?</p>' + 
						'<div class="progress"><div class="progress-bar" role="progressbar" aria-valuenow="60" aria-valuemin="0" aria-valuemax="100" style="width: 25%;">25%</div>' + 
						'</div><p><a href="#" class="btn btn-danger" role="button">Verkaufen</a> <a href="#" class="btn btn-primary" role="button">Informationen</a></p>' + 
						'</div></div></div>';
			}*/
					
				}
			});
		}

		function getSpielername(){
			jQuery.ajax({
				url: "../api/spiel/unternehmen",
				type: "GET",
				dataType: "json",
				success: function(data, data2){
					var cont  = document.getElementById('spielerName');
					var s =data.name;
					cont.innerHTML += s;
					//console.log(data.kapital);
					//console.log(data.bmarkt.angebote);
					//console.log(data.mmarkt.angebote);
					
				}
			});
		}

		function getRunde(){
			jQuery.ajax({
				url: "../api/spiel/zwischenstand",
				type: "GET",
				dataType: "json",
				success: function(data, data2){
					var cont  = document.getElementById('runde');
					var s =data.runde;
					cont.innerHTML += s;
					console.log(data.runde);
					//console.log(data.bmarkt.angebote);
					//console.log(data.mmarkt.angebote);
					
				}
			});
		}

		function beendeZug(){
			jQuery.ajax({
				url: "../api/spiel/zugbeendet",
				type: "GET",
				dataType: "json",
				success: function(data, data2){
					var runde = data;
					console.log(data);
					if (runde>0) {
						window.location.href = "ergebnis_runde.html";
					} else if (runde==0) {
						$(document).ready(function(){
  								$('#modalContent').modal('show');
								});

						window.setTimeout(function(){
			            window.location.href = "einkauf.html";
			            }, 5000); //Test: 5sec 
					} else {
						window.location.href = "ergebnis_ende.html";
					}
				}

			});
			}

			function ladeErgebnisLetzteRunde(){
			jQuery.ajax({
				url: "../api/spiel/rundenresultat",
				type: "GET",
				dataType: "json",
				success: function(data, data2){
					var einnahmen  = document.getElementById('einnahmen');
					var ausgaben  = document.getElementById('ausgaben');
					var kapital  = document.getElementById('kapital');
					var marketingMaßnahmen = document.getElementById('marketingMaßnahmen');
					
					var einnahmenData =data.guv.einnahmen;
					var ausgabenData =data.guv.ausgaben;
					var kapitalData =data.kapital;
					var marketingMaßnahmenData = data.marketingMaßnahmen;
					
					einnahmen.innerHTML = einnahmenData;
					ausgaben.innerHTML =ausgabenData;
					kapital.innerHTML = kapitalData;
					marketingMaßnahmen = marketingMaßnahmenData;
					
					//console.log(data.kapital);
					//console.log(data.bmarkt.angebote);
					//console.log(data.mmarkt.angebote);
					
				}
			});
		}

		

</script>
     <div class="navbar navbar-default navbar-fixed-top" role="navigation">
		<div class="container">
			<div class="navbar-header">
				<button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
					<span class="sr-only">Toggle navigation</span>
					<span class="icon-bar"></span>
					<span class="icon-bar"></span>
					<span class="icon-bar"></span>
				</button>
				<a class="navbar-brand">Unternehmensplanspiel</a>
			</div>
			<div class="navbar-collapse collapse">
		
				<ul class="nav navbar-nav navbar-default">
					<!-- Einkauf -->					
					<li class="dropdown">
						<a href="#" class="dropdown-toggle" data-toggle="dropdown">Einkauf <b class="caret"></b></a>
						<ul class="dropdown-menu">
							<li><a href="einkauf.html">Einkauf</a></li>         
						</ul>
					</li>

					<!-- Verarbeitung -->
					<li class="dropdown">
						<a href="verarbeitung.html" class="dropdown-toggle" data-toggle="dropdown">Verarbeitung <b class="caret"></b></a>
						<ul class="dropdown-menu">
						
							<li><a href="verarbeitung.html">Verarbeitung</a></li>
							<li class="divider"></li>
							<li class="dropdown-header">Produkte</li>
							<li><a href="#">Stühle</a></li>
							<li><a href="#">Tische</a></li>
							<li><a href="#">Schränke</a></li>
						</ul>
					</li>      

					<!-- Verkauf -->
					<li class="dropdown">
						<a href="#" class="dropdown-toggle" data-toggle="dropdown">Verkauf <b class="caret"></b></a>
						<ul class="dropdown-menu">
						
							<li><a href="verkauf.html">Verkauf</a></li>
							<li><a href="marketing.html">Marketing</a></li>
							<li class="divider"></li>
							<li class="dropdown-header">Angebote</li>
							<li><a href="#">Neues Angebot</a></li>
							<li><a href="#">Bestehende Angebote</a></li>
						</ul>
					</li>

					<!--Inventar-->
					<li class="dropdown">
						<a href="#" class="dropdown-toggle" data-toggle="dropdown">Inventar <b class="caret"></b></a>
						<ul class="dropdown-menu">
							<li><a href="mitarbeiter.html">Mitarbeiter</a></li>
							<li><a href="rohstoffe.html">Rohstoffe</a></li>
							<li><a href="fertigeerzeugnisse.html">Fertige Erzeugnisse</a></li>
							<li><a href="maschinen.html">Maschinen</a></li>	
						</ul>
					</li>
					<li><a data-toggle="modal" href="#ergebnisLetzteRundeModal" onclick="ladeErgebnisLetzteRunde()">Ergebnis der letzten Runde</a></li>        
				</ul>

				<ul class="nav navbar-nav navbar-right">
					<!--<li><a href="#about">Zeit: 00:00</a></li>-->
					<li ><a id="spielerName">Unternehmen: </a></li>					
					<!--  <li><img src="img/account.svg"></img></li>-->
					<li class="dropdown">
						<a href="#" class="dropdown-toggle" data-toggle="dropdown"><img src="img/account.svg"></img> <b class="caret"></b></a>
						<ul class="dropdown-menu">
						
							<li><a id="runde">Runde: </a></li>
							<li><a href="#budget" id="exampleContent">Kapital: </a></li>

							<li class="divider"></li>		
							<li><a class="btn float-right" onclick="beendeZug()" data-toggle="modal">Zug beenden</a> </li>
							<!-- data-toggle="modal" data-target="#modalContent"-->
						</ul>
					</li>        
				</ul>
			</div><!--/.nav-collapse -->
		</div>       
    </div>

    <!-- Modal -->
        <div class="modal fade" id="modalContent" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
          <div class="modal-dialog">
            <!-- Modal content-->
            <div class="modal-content">
              <div class="modal-header">
                <h4 class="modal-title">Hinweis</h4>
              </div>
              <div class="modal-body">
                <h2>Der nächste Spieler ist in 30 Sekunden an der Reihe!</h2>
                    <br>
                    <p>Viel Erfolg!</p>
              </div>
            </div>

          </div>
        </div>

            <!-- Modal -->
        <div class="modal fade" id="ergebnisLetzteRundeModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
          <div class="modal-dialog">
            <!-- Modal content-->
            <div class="modal-content">
              <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal">&times;</button>
                <h4 class="modal-title">Hinweis</h4>
              </div>
              <div class="modal-body">
                <h2>Dein Ergebnis der letzten Runde</h2>
                    <br>
                    <table class="table table-bordered table-sm m-0">
                    <tbody>
                        <tr>
                        	<th class="col-sm-1">Einnahmen</th>
                            <td id="einnahmen"> 0€</td>
                        </tr>
                        <tr>
                        	<th class="col-sm-1">Ausgaben</th>
                            <td id="ausgaben"> 0€</td>
                        </tr>
                        <tr>
                            <th class="col-sm-1">Kapital</th>
                            <td id="kapital"> 0€</td>
                        </tr>
                        <tr>
                        	<th class="col-sm-1">Marketingmaßnahmen</th>
                            <td id="marketingMaßnahmen"></td>
                        </tr>
                        <tr>
                        	<th class="col-sm-1">Mitarbeiteranzahl</th>
                            <td id="mitarbeiterAnzahl"></td>
                        </tr>
                    </tbody>
                </table>
              </div>
            </div>

          </div>
        </div>



</body>